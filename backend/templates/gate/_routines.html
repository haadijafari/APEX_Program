<h4 class="mb-3 text-muted">Active Routines</h4>

{% for routine in routines %}
    <div class="card mb-3 border-secondary shadow-sm">
        <div class="card-header fw-bold border-secondary">
            {{ routine.title }}
        </div>
        <ul class="list-group list-group-flush">
            {# Iterate over 'subtasks' (Related Name in Task model) #}
            {% for subtask in routine.subtasks.all %}
                <li class="list-group-item d-flex align-items-center">
                    <input class="form-check-input me-2 js-routine-toggle" 
                        type="checkbox" 
                        value="" 
                        id="task-{{ subtask.id }}"
                        data-task-id="{{ subtask.id }}"
                        {% if subtask.id in completed_task_ids %}checked{% endif %}>
                    
                    <label class="form-check-label stretched-link text-reset" for="task-{{ subtask.id }}">
                        {{ subtask.title }}
                    </label>
                </li>
            {% endfor %}
        </ul>
    </div>
{% empty %}
    <div class="alert alert-info">No routines set up yet!</div>
{% endfor %}
