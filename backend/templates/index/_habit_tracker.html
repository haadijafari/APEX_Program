<div class="card border-secondary shadow-sm">
    <div class="card-header border-secondary bg-transparent d-flex justify-content-between align-items-center">
        <span class="text-secondary text-uppercase small ls-1">Habit Tracker</span>
        <span class="fw-bold text-system">{{ current_month_name }}</span>
    </div>
    <div class="card-body p-0">
        <table class="table table-dark table-borderless table-sm mb-0 text-center align-middle habit-tracker-table">
            <thead>
                <tr>
                    <th class="text-start ps-3 text-muted habit-header-title">Habit</th>
                    {% for day in month_days %}
                        <th class="small habit-header-day {% if day == current_day_number %}text-system fw-bold{% else %}text-secondary fw-light{% endif %}">{{ day }}</th>
                    {% endfor %}
                </tr>
            </thead>
            <tbody>
                {% for habit in habit_grid %}
                <tr>
                    <td class="text-start ps-3 fw-bold text-light">{{ habit.title }}</td>
                    {% for cell in habit.status %}
                        <td class="habit-cell-interactive" 
                            onclick="toggleHabit({{ habit.id }}, '{{ cell.date }}', this, {{ forloop.counter0 }})"
                            title="Toggle status for {{ cell.date }}">
                            
                            <span class="status-icon">
                            {% if cell.state == 'completed' %}
                                <span class="fs-6">✅</span>
                            {% elif cell.state == 'today' %}
                                <span class="text-warning">●</span>
                            {% elif cell.state == 'missed' %}
                                <span class="text-danger opacity-50">✕</span>
                            {% else %}
                                <span class="text-secondary opacity-25">·</span>
                            {% endif %}
                            </span>

                        </td>
                    {% endfor %}
                </tr>
                {% empty %}
                <tr>
                    <td colspan="32" class="text-muted py-3">No active habits found.</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
